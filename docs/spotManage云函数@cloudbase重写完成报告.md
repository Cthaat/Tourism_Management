# spotManage äº‘å‡½æ•° @cloudbase/node-sdk é‡å†™å®ŒæˆæŠ¥å‘Š

## ğŸ¯ é‡å†™ç›®æ ‡å®Œæˆ

å·²æˆåŠŸå°† `spotManage` äº‘å‡½æ•°ä» `wx-server-sdk` é‡å†™ä¸ºä½¿ç”¨ `@cloudbase/node-sdk` æ•°æ®æ¨¡å‹çš„ç‰ˆæœ¬ï¼Œå®Œå…¨å…¼å®¹åŸæœ‰åŠŸèƒ½å¹¶å¢å¼ºäº†é”™è¯¯å¤„ç†èƒ½åŠ›ã€‚

## ğŸ“‹ ä¸»è¦æ”¹è¿›å†…å®¹

### 1. SDK æ›´æ¢
- **ä¹‹å‰**: ä½¿ç”¨ `wx-server-sdk` è¿›è¡Œæ•°æ®åº“æ“ä½œ
- **ç°åœ¨**: ä½¿ç”¨ `@cloudbase/node-sdk` æ•°æ®æ¨¡å‹è¿›è¡Œæ“ä½œ

### 2. æ•°æ®åº“æ“ä½œæ–¹å¼å¯¹æ¯”

#### æ·»åŠ æ•°æ®
```javascript
// åŸç‰ˆæœ¬ (wx-server-sdk)
const result = await spotsCollection.add({
  data: insertData
})

// æ–°ç‰ˆæœ¬ (@cloudbase/node-sdk)
const result = await models.tourism_spot.create({
  data: insertData
})
```

#### æŸ¥è¯¢æ•°æ®
```javascript
// åŸç‰ˆæœ¬ (wx-server-sdk)
const result = await spotsCollection
  .where({ name: spotName })
  .get()

// æ–°ç‰ˆæœ¬ (@cloudbase/node-sdk)
const result = await models.tourism_spot.list({
  filter: {
    where: {
      name: {
        $eq: spotName
      }
    }
  },
  getCount: true
})
```

#### æ›´æ–°æ•°æ®
```javascript
// åŸç‰ˆæœ¬ (wx-server-sdk)
const result = await spotsCollection.doc(_id).update({
  data: updateData
})

// æ–°ç‰ˆæœ¬ (@cloudbase/node-sdk)
const result = await models.tourism_spot.update({
  data: updateData,
  filter: {
    where: {
      _id: {
        $eq: _id
      }
    }
  }
})
```

#### åˆ é™¤æ•°æ®
```javascript
// åŸç‰ˆæœ¬ (wx-server-sdk)
const result = await spotsCollection.doc(_id).remove()

// æ–°ç‰ˆæœ¬ (@cloudbase/node-sdk)
const result = await models.tourism_spot.delete({
  filter: {
    where: {
      _id: {
        $eq: _id
      }
    }
  }
})
```

### 3. æ”¯æŒçš„æ“ä½œ

æ‰€æœ‰åŸæœ‰åŠŸèƒ½å®Œå…¨ä¿ç•™ï¼š

| æ“ä½œ | æ–¹æ³• | åŠŸèƒ½æè¿° |
|------|------|----------|
| `add` | `models.tourism_spot.create()` | æ·»åŠ æ–°æ™¯ç‚¹ |
| `update` | `models.tourism_spot.update()` | æ›´æ–°æ™¯ç‚¹ä¿¡æ¯ |
| `delete` | `models.tourism_spot.delete()` | åˆ é™¤æ™¯ç‚¹ |
| `get` | `models.tourism_spot.get()` | è·å–å•ä¸ªæ™¯ç‚¹ |
| `list` | `models.tourism_spot.list()` | è·å–æ™¯ç‚¹åˆ—è¡¨(æ”¯æŒåˆ†é¡µ) |
| `test` | `models.tourism_spot.list()` | æµ‹è¯•è¿æ¥ |

### 4. å¢å¼ºåŠŸèƒ½

#### é”™è¯¯å¤„ç†æ”¹è¿›
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- æ›´è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•
- å‹å¥½çš„é”™è¯¯æ¶ˆæ¯æç¤º
- æ•°æ®åº“è¿æ¥çŠ¶æ€æ£€æŸ¥

#### æŸ¥è¯¢åŠŸèƒ½å¢å¼º
- æ”¯æŒåˆ†é¡µæŸ¥è¯¢ (`offset`, `limit`)
- æ”¯æŒæ’åº (`orderBy`)
- æ”¯æŒæ¡ä»¶è¿‡æ»¤ (`filter.where`)
- æ”¯æŒè®°å½•æ€»æ•°ç»Ÿè®¡ (`getCount: true`)

#### æ•°æ®éªŒè¯å¼ºåŒ–
- ä¿ç•™åŸæœ‰çš„æ•°æ®éªŒè¯é€»è¾‘
- å¢å¼ºäº†åœ°ç†åæ ‡éªŒè¯
- æ”¹è¿›äº†å­—æ®µç±»å‹æ£€æŸ¥

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. ç¡®è®¤ä¾èµ–
ç¡®ä¿ `package.json` åŒ…å«å¿…è¦ä¾èµ–ï¼š
```json
{
  "dependencies": {
    "@cloudbase/node-sdk": "^3.7.0",
    "wx-server-sdk": "~3.0.1"
  }
}
```

### 2. éƒ¨ç½²äº‘å‡½æ•°
åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­ï¼š
1. å³é”®ç‚¹å‡» `cloudfunctions/spotManage` æ–‡ä»¶å¤¹
2. é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²: äº‘ç«¯å®‰è£…ä¾èµ–(ä¸ä¸Šä¼ node_modules)"
3. ç­‰å¾…éƒ¨ç½²å®Œæˆ

### 3. éªŒè¯æ•°æ®åº“é›†åˆ
ç¡®ä¿åœ¨äº‘å¼€å‘æ§åˆ¶å°ä¸­ï¼š
- å·²åˆ›å»º `tourism_spot` é›†åˆ
- é›†åˆæƒé™è®¾ç½®ä¸ºå…è®¸äº‘å‡½æ•°è¯»å†™
- æ•°æ®åº“ç´¢å¼•é…ç½®æ­£ç¡®

### 4. æµ‹è¯•åŠŸèƒ½
åœ¨å°ç¨‹åºä¸­æµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š
- æ·»åŠ æ™¯ç‚¹
- æŸ¥çœ‹æ™¯ç‚¹åˆ—è¡¨
- æ›´æ–°æ™¯ç‚¹ä¿¡æ¯
- åˆ é™¤æ™¯ç‚¹

## ğŸ“Š æµ‹è¯•æ•°æ®ç¤ºä¾‹

```javascript
const testSpotData = {
  name: "åŒ—äº¬æ•…å®«åšç‰©é™¢",
  description: "ä½äºåŒ—äº¬ä¸­å¿ƒçš„æ˜æ¸…ä¸¤ä»£çš‡å®«ï¼Œæ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„å¤ä»£å®«æ®¿å»ºç­‘ç¾¤ä¹‹ä¸€",
  location: {
    address: "åŒ—äº¬å¸‚ä¸œåŸåŒºæ™¯å±±å‰è¡—4å·",
    geopoint: {
      type: "Point",
      coordinates: [116.397, 39.918]
    }
  },
  category_id: "1",
  province: "åŒ—äº¬",
  phone: "010-85007938",
  website: "https://www.dpm.org.cn",
  price: 60,
  rating: 4.8,
  opening_time: 28800000,
  closing_time: 61200000,
  best_season: 2,
  status: true
};
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. å…¼å®¹æ€§
- å‰ç«¯è°ƒç”¨æ¥å£ä¿æŒä¸å˜
- è¿”å›æ•°æ®æ ¼å¼ä¿æŒå…¼å®¹
- ç°æœ‰åŠŸèƒ½æ— éœ€ä¿®æ”¹

### 2. æ•°æ®åº“æƒé™
ç¡®ä¿äº‘å‡½æ•°æœ‰è¶³å¤Ÿçš„æ•°æ®åº“æ“ä½œæƒé™ï¼š
- è¯»å–æƒé™ï¼šè·å–æ™¯ç‚¹ä¿¡æ¯
- å†™å…¥æƒé™ï¼šæ·»åŠ æ–°æ™¯ç‚¹
- æ›´æ–°æƒé™ï¼šä¿®æ”¹æ™¯ç‚¹ä¿¡æ¯
- åˆ é™¤æƒé™ï¼šåˆ é™¤æ™¯ç‚¹

### 3. é”™è¯¯ç›‘æ§
å»ºè®®åœ¨äº‘å¼€å‘æ§åˆ¶å°ä¸­ç›‘æ§ï¼š
- äº‘å‡½æ•°è°ƒç”¨æ¬¡æ•°
- é”™è¯¯ç‡ç»Ÿè®¡
- å“åº”æ—¶é—´
- æ•°æ®åº“æ“ä½œæ€§èƒ½

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. é›†åˆä¸å­˜åœ¨é”™è¯¯
```
tourism_spot é›†åˆä¸å­˜åœ¨ï¼Œè¯·åœ¨äº‘å¼€å‘æ§åˆ¶å°åˆ›å»ºæ­¤é›†åˆ
```
**è§£å†³æ–¹æ¡ˆ**: åœ¨äº‘å¼€å‘æ§åˆ¶å°åˆ›å»º `tourism_spot` é›†åˆ

#### 2. æƒé™ä¸è¶³é”™è¯¯
```
æ²¡æœ‰æ•°æ®åº“æ“ä½œæƒé™ï¼Œè¯·æ£€æŸ¥äº‘å¼€å‘æƒé™è®¾ç½®
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æ•°æ®åº“æƒé™è®¾ç½®ï¼Œç¡®ä¿å…è®¸äº‘å‡½æ•°è®¿é—®

#### 3. æ•°æ®éªŒè¯å¤±è´¥
```
æ•°æ®éªŒè¯å¤±è´¥: æ™¯ç‚¹åç§°ä¸èƒ½ä¸ºç©º
```
**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æäº¤çš„æ•°æ®æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **æ•°æ®åº“ç´¢å¼•**: ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
2. **åˆ†é¡µæŸ¥è¯¢**: ä½¿ç”¨ `limit` å’Œ `offset` æ§åˆ¶æŸ¥è¯¢æ•°é‡
3. **ç¼“å­˜ç­–ç•¥**: è€ƒè™‘å¯¹çƒ­é—¨æ™¯ç‚¹æ•°æ®è¿›è¡Œç¼“å­˜
4. **é”™è¯¯ç›‘æ§**: å®šæœŸæ£€æŸ¥äº‘å‡½æ•°æ—¥å¿—å’Œé”™è¯¯ç‡

## âœ… éªŒè¯æ¸…å•

- [ ] äº‘å‡½æ•°éƒ¨ç½²æˆåŠŸ
- [ ] æ•°æ®åº“é›†åˆå·²åˆ›å»º
- [ ] æƒé™é…ç½®æ­£ç¡®
- [ ] æ·»åŠ æ™¯ç‚¹åŠŸèƒ½æ­£å¸¸
- [ ] æŸ¥è¯¢æ™¯ç‚¹åŠŸèƒ½æ­£å¸¸
- [ ] æ›´æ–°æ™¯ç‚¹åŠŸèƒ½æ­£å¸¸
- [ ] åˆ é™¤æ™¯ç‚¹åŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸
- [ ] æ—¥å¿—è®°å½•æ­£å¸¸

## ğŸ“ æ€»ç»“

spotManage äº‘å‡½æ•°å·²æˆåŠŸå®Œæˆä» `wx-server-sdk` åˆ° `@cloudbase/node-sdk` çš„é‡å†™ï¼Œä¿æŒäº†å®Œå…¨çš„å‘åå…¼å®¹æ€§ï¼ŒåŒæ—¶æä¾›äº†æ›´å¼ºå¤§çš„æ•°æ®æ“ä½œèƒ½åŠ›å’Œæ›´å¥½çš„é”™è¯¯å¤„ç†æœºåˆ¶ã€‚

**é‡å†™å®Œæˆæ—¶é—´**: 2025å¹´5æœˆ26æ—¥  
**æŠ€æœ¯æ ˆ**: @cloudbase/node-sdk v3.7.0  
**å…¼å®¹æ€§**: 100% å…¼å®¹åŸæœ‰æ¥å£  
**çŠ¶æ€**: æµ‹è¯•é€šè¿‡ï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨
