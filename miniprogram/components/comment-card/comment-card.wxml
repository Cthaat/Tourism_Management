<!-- filepath: c:\Code\Tourism_Management\miniprogram\components\comment-card\comment-card.wxml -->
<!-- ================================================================
 * æ–‡ä»¶å: comment-card.wxml
 * æè¿°: è¯„è®ºå¡ç‰‡ç»„ä»¶çš„ç»“æ„æ–‡ä»¶
 * ç‰ˆæœ¬: 1.0.0
 * åˆ›å»ºæ—¥æœŸ: 2025-05-30
 * ä½œè€…: Tourism_Managementå¼€å‘å›¢é˜Ÿ
 * 
 * åŠŸèƒ½è¯´æ˜:
 * - å±•ç¤ºç”¨æˆ·è¯„è®ºçš„å®Œæ•´ä¿¡æ¯
 * - åŒ…å«ç”¨æˆ·å¤´åƒã€æ˜µç§°ã€è¯„åˆ†å’Œè¯„è®ºå†…å®¹
 * - æ”¯æŒç‚¹èµã€å›å¤å’ŒæŸ¥çœ‹æ›´å¤šåŠŸèƒ½
 * - é€‚é…æ·±è‰²æ¨¡å¼å’Œå¤šä¸»é¢˜è‰²å½©
 * ================================================================ -->
<view class="comment-card {{isDarkMode ? 'dark-mode' : ''}}" data-theme="{{colorTheme}}">
  <!-- è¯„è®ºå¡ç‰‡å¤´éƒ¨ -->
  <view class="comment-header">
    <!-- ç”¨æˆ·å¤´åƒ -->
    <view class="user-avatar" bindtap="viewProfile">
      <image class="avatar-image" src="{{comment.userAvatar || '/images/default-avatar.png'}}" mode="aspectFill" />
    </view>
    <!-- ç”¨æˆ·ä¿¡æ¯å’Œè¯„åˆ† -->
    <view class="user-info">
      <view class="user-name" bindtap="viewProfile">
        {{comment.userName || 'åŒ¿åç”¨æˆ·'}}
      </view>
      <view class="rating-section">
        <!-- æ˜Ÿçº§è¯„åˆ† -->
        <text class="rating-text">{{comment.rating}}/5</text>
        <view class="stars">
          <block wx:for="{{5}}" wx:key="index">
            <text class="star {{index < comment.rating ? 'filled' : ''}}">
              â­
            </text>
          </block>
        </view>
      </view>
      <view class="comment-time">{{comment.timeAgo || 'åˆšåˆš'}}</view>
    </view>
    <!-- æ›´å¤šæ“ä½œæŒ‰é’® -->
    <view class="more-actions">
      <text class="more-icon">â‹¯</text>
    </view>
  </view>
  <!-- è¯„è®ºå†…å®¹ -->
  <view class="comment-content">
    <!-- è¯„è®ºæ–‡æœ¬ -->
    <view class="comment-text {{showFullContent ? 'expanded' : ''}}">
      {{comment.content}}
    </view>
    <!-- å±•å¼€/æ”¶èµ·æŒ‰é’® (ä»…å½“å†…å®¹è¾ƒé•¿æ—¶æ˜¾ç¤º) -->
    <view wx:if="{{comment.content.length > 120}}" class="expand-button" bindtap="toggleContent">
      <text class="expand-text">{{showFullContent ? 'æ”¶èµ·' : 'å±•å¼€'}}</text>
    </view>
    <!-- è¯„è®ºå›¾ç‰‡ (å¦‚æœæœ‰) -->
    <view wx:if="{{comment.images && comment.images.length > 0}}" class="comment-images">
      <block wx:for="{{comment.images}}" wx:key="index">
        <image class="comment-image" src="{{item}}" mode="aspectFill" data-src="{{item}}" bindtap="previewImage" />
      </block>
    </view>
  </view>
  <!-- è¯„è®ºåº•éƒ¨æ“ä½œ -->
  <view class="comment-actions">
    <!-- æœ‰ç”¨è¯„ä»· -->
    <view class="action-item">
      <text class="action-icon">ğŸ‘</text>
      <text class="action-text">æœ‰ç”¨ ({{comment.helpfulCount || 0}})</text>
    </view>
    <!-- ç‚¹èµ -->
    <view class="action-item like-action {{isLiked ? 'liked' : ''}}" bindtap="handleLike">
      <text class="action-icon">{{isLiked ? 'â¤ï¸' : 'â™¡'}}</text>
      <text class="action-text">{{likeCount > 0 ? likeCount : 'ç‚¹èµ'}}</text>
    </view>
    <!-- å›å¤ -->
    <view class="action-item" bindtap="handleReply">
      <text class="action-icon">ğŸ’¬</text>
      <text class="action-text">å›å¤</text>
    </view>
    <!-- åˆ†äº« -->
    <view class="action-item">
      <text class="action-icon">ğŸ“¤</text>
      <text class="action-text">åˆ†äº«</text>
    </view>
  </view>
  <!-- å›å¤åˆ—è¡¨ (å¦‚æœæœ‰å›å¤) -->
  <view wx:if="{{comment.replies && comment.replies.length > 0}}" class="replies-section">
    <view class="replies-header">
      <text class="replies-count">{{comment.replies.length}}æ¡å›å¤</text>
    </view>
    <view class="replies-list">
      <view wx:for="{{comment.replies}}" wx:key="id" class="reply-item">
        <view class="reply-user">{{item.userName}}:</view>
        <view class="reply-content">{{item.content}}</view>
        <view class="reply-time">{{item.timeAgo}}</view>
      </view>
    </view>
  </view>
</view>