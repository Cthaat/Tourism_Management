<!-- * æ–‡ä»¶å: log-viewer.wxml
  * æè¿°: æ—…æ¸¸ç®¡ç†å¾®ä¿¡å°ç¨‹åºæ—¥å¿—æŸ¥çœ‹å™¨é¡µé¢æ¨¡æ¿
  * ç‰ˆæœ¬: 1.0.0
  * åˆ›å»ºæ—¥æœŸ: 2025-05-20
  * ä½œè€…: Tourism_Managementå¼€å‘å›¢é˜Ÿ
  *
  * åŠŸèƒ½è¯´æ˜:
  * - æ—¥å¿—åˆ—è¡¨æ˜¾ç¤º
  * - æ—¥å¿—çº§åˆ«è¿‡æ»¤
  * - æœç´¢åŠŸèƒ½
  * - å¯¼å‡ºä¸åˆ†äº«
  * - æ”¯æŒæ·±è‰²æ¨¡å¼ -->
<!-- æ—¥å¿—æŸ¥çœ‹å™¨å®¹å™¨ -->
<view class="log-viewer-container {{isDarkMode ? 'dark-mode' : ''}}" data-theme="{{colorTheme}}">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="toolbar {{isDarkMode ? 'dark-mode' : ''}}">
    <!-- æœç´¢æ¡† -->
    <view class="search-bar {{isDarkMode ? 'dark-mode' : ''}}">
      <input type="text" placeholder="æœç´¢æ—¥å¿—..." value="{{searchQuery}}" bindinput="onSearchInput" class="search-input {{isDarkMode ? 'dark-mode' : ''}}" />
      <view class="search-icon {{isDarkMode ? 'dark-mode' : ''}}">ğŸ”</view>
    </view>
    <!-- æ—¥æœŸé€‰æ‹©å™¨ -->
    <view class="date-selector {{isDarkMode ? 'dark-mode' : ''}}">
      <view class="current-date {{isDarkMode ? 'dark-mode' : ''}}" bindtap="toggleDatePicker">
        <text>æ—¥æœŸ: {{formatDisplayDate(currentLogDate)}}</text>
        <text class="dropdown-arrow">â–¼</text>
      </view>
      <!-- æ—¥æœŸä¸‹æ‹‰é€‰æ‹©å™¨ -->
      <view class="date-dropdown {{showDatePicker ? 'show' : 'hide'}} {{isDarkMode ? 'dark-mode' : ''}}">
        <view wx:for="{{availableLogFiles}}" wx:key="dateString" class="date-option {{isDarkMode ? 'dark-mode' : ''}}" bindtap="selectLogDate" data-date="{{item.dateString}}">
          {{item.displayDate}}
        </view>
        <view wx:if="{{availableLogFiles.length === 0}}" class="no-dates {{isDarkMode ? 'dark-mode' : ''}}">
          æ— å¯ç”¨æ—¥å¿—æ–‡ä»¶
        </view>
      </view>
    </view>
    <!-- æ“ä½œæŒ‰é’® -->
    <view class="action-buttons">
      <button bindtap="exportLogs" class="action-button {{isDarkMode ? 'dark-mode' : ''}}">
        å¯¼å‡º
      </button>
      <button bindtap="refreshLogs" class="action-button {{isDarkMode ? 'dark-mode' : ''}}">
        åˆ·æ–°
      </button>
      <button bindtap="clearFilters" class="action-button {{isDarkMode ? 'dark-mode' : ''}}">
        æ¸…é™¤è¿‡æ»¤
      </button>
    </view>
  </view>
  <!-- æ—¥å¿—çº§åˆ«è¿‡æ»¤å™¨ -->
  <view class="filter-tabs {{isDarkMode ? 'dark-mode' : ''}}">
    <view class="filter-tab {{activeFilter === 'ALL' ? 'active' : ''}} {{isDarkMode ? 'dark-mode' : ''}}" bindtap="filterByLevel" data-level="ALL">
      å…¨éƒ¨
    </view>
    <view class="filter-tab {{activeFilter === 'DEBUG' ? 'active' : ''}} {{isDarkMode ? 'dark-mode' : ''}}" bindtap="filterByLevel" data-level="DEBUG">
      è°ƒè¯•
    </view>
    <view class="filter-tab {{activeFilter === 'INFO' ? 'active' : ''}} {{isDarkMode ? 'dark-mode' : ''}}" bindtap="filterByLevel" data-level="INFO">
      ä¿¡æ¯
    </view>
    <view class="filter-tab {{activeFilter === 'WARN' ? 'active' : ''}} {{isDarkMode ? 'dark-mode' : ''}}" bindtap="filterByLevel" data-level="WARN">
      è­¦å‘Š
    </view>
    <view class="filter-tab {{activeFilter === 'ERROR' ? 'active' : ''}} {{isDarkMode ? 'dark-mode' : ''}}" bindtap="filterByLevel" data-level="ERROR">
      é”™è¯¯
    </view>
  </view>
  <!-- æ—¥å¿—å†…å®¹ -->
  <scroll-view scroll-y="true" class="logs-container {{isDarkMode ? 'dark-mode' : ''}}">
    <!-- åŠ è½½ä¸­æç¤º -->
    <view wx:if="{{isLoading}}" class="loading-text {{isDarkMode ? 'dark-mode' : ''}}">
      åŠ è½½æ—¥å¿—ä¸­...
    </view>
    <!-- æ— æ—¥å¿—æç¤º -->
    <view wx:elif="{{filteredLogs.length === 0}}" class="empty-logs {{isDarkMode ? 'dark-mode' : ''}}">
      <view class="empty-icon">ğŸ“‹</view>
      <text>æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ—¥å¿—è®°å½•</text>
    </view>
    <!-- æ—¥å¿—åˆ—è¡¨ -->
    <view wx:else class="log-list">
      <view wx:for="{{filteredLogs}}" wx:key="index" class="log-item {{item.levelClass}} {{isDarkMode ? 'dark-mode' : ''}}">
        <!-- æ—¥å¿—å¤´éƒ¨ä¿¡æ¯ï¼ˆæ—¶é—´æˆ³ã€çº§åˆ«ã€æ¥æºï¼‰ -->
        <block wx:if="{{item.level}}">
          <view class="log-header {{isDarkMode ? 'dark-mode' : ''}}">
            <text class="log-timestamp {{isDarkMode ? 'dark-mode' : ''}}">
              {{item.timestamp}}
            </text>
            <text class="log-level {{item.levelClass}} {{isDarkMode ? 'dark-mode' : ''}}">
              {{item.level}}
            </text>
            <text class="log-source {{isDarkMode ? 'dark-mode' : ''}}">
              {{item.source}}
            </text>
          </view>
        </block>
        <!-- æ—¥å¿—æ¶ˆæ¯å†…å®¹ -->
        <view class="log-message {{isDarkMode ? 'dark-mode' : ''}}">
          <!-- å¦‚æœæ˜¯JSONå¯¹è±¡ï¼Œä½¿ç”¨code-format-containeråŒ…è£¹preæ ‡ç­¾ -->
          <block wx:if="{{item.isJsonObject}}">
            <view class="code-format-container">
              <pre class="code-format">{{item.message}}</pre>
            </view>
          </block>
          <!-- æ™®é€šæ–‡æœ¬æ¶ˆæ¯ -->
          <block wx:else>
            <text space="nbsp" decode>{{item.message}}</text>
          </block>
        </view>
      </view>
    </view>
  </scroll-view>
  <!-- åº•éƒ¨ä¿¡æ¯ -->
  <view class="footer {{isDarkMode ? 'dark-mode' : ''}}">
    <text>æ—¥å¿—è®°å½•æ€»æ•°: {{filteredLogs.length}}</text>
  </view>
</view>