<!-- * æ–‡ä»¶å: index.wxml
 * æè¿°: æ—…æ¸¸ç®¡ç†å¾®ä¿¡å°ç¨‹åºé¦–é¡µå¸ƒå±€æ–‡ä»¶
 * ç‰ˆæœ¬: 1.0.0
 * åˆ›å»ºæ—¥æœŸ: 2023-05-13
 * ä½œè€…: Tourism_Managementå¼€å‘å›¢é˜Ÿ
 * 
 * åŠŸèƒ½è¯´æ˜:
 * - é¦–é¡µä¸»ç•Œé¢å¸ƒå±€ç»“æ„
 * - æ™¯ç‚¹æœç´¢æ¡†
 * - æ™¯ç‚¹è½®æ’­å›¾å±•ç¤º
 * - åˆ†ç±»å¯¼èˆªå’Œçƒ­é—¨æ™¯ç‚¹åˆ—è¡¨
 * - æ·±è‰²/æµ…è‰²æ¨¡å¼é€‚é… -->
<!-- ä¸»å®¹å™¨ - æ ¹æ®ä¸»é¢˜æ¨¡å¼åº”ç”¨ä¸åŒæ ·å¼ -->
<view class="container {{isDarkMode ? 'dark-mode' : ''}}" data-theme="{{colorTheme}}" style="--theme-color: {{colorTheme === 'å¤©ç©ºè“' ? '#1296db' : colorTheme === 'ä¸­å›½çº¢' ? '#e54d42' : '#1aad19'}}; --theme-bg-color: {{colorTheme === 'å¤©ç©ºè“' ? '#1296db' : colorTheme === 'ä¸­å›½çº¢' ? '#e54d42' : '#4CAF50'}};">
	<!-- è½®æ’­å›¾èƒŒæ™¯ - å…¨å±èƒŒæ™¯å›¾è½®æ’­ -->
	<view class="fullscreen-banner">
		<swiper
		 class="banner-container"
		 indicator-dots="true"
		 autoplay="true"
		 interval="3000"
		 duration="500"
		 circular="true"
		 disable-touch="{{false}}"
		 easing-function="default"
		 bindchange="onBannerChange"
		 bindanimationfinish="onBannerAnimationFinish"
		 bindtouchstart="onBannerTouchStart"
		 bindtouchend="onBannerTouchEnd"
		>
			<!-- è½®æ’­å›¾é¡¹ - å¾ªç¯æ¸²æŸ“æ™¯ç‚¹å›¾ç‰‡ -->
			<swiper-item
			 wx:for="{{banners}}"
			 wx:key="id"
			 bindtap="onBannerTap"
			 data-id="{{item.id}}"
			 data-index="{{index}}"
			>
				<image
				 class="banner-image"
				 src="{{item.mainImage || item.images[0] || item.image || '/images/zhangjiajie.png'}}"
				 mode="aspectFill"
				 data-id="{{item.id}}"
				 data-index="{{index}}"
				 bindload="onBannerImageLoad"
				 binderror="onBannerImageError"
				/>
				<view class="banner-title {{isDarkMode ? 'dark-mode' : ''}}" data-id="{{item.id}}" data-index="{{index}}">
					{{item.name}}
				</view>
			</swiper-item>
		</swiper>
		<!-- é¡¶éƒ¨æ¸å˜é®ç½© - å¢å¼ºé¡¶éƒ¨æ–‡å­—å¯è¯»æ€§ -->
		<view class="banner-top-gradient" />
	</view>
	<!-- ä¸»ä½“å†…å®¹åŒºåŸŸ - å¯æ»‘åŠ¨è¦†ç›–è½®æ’­å›¾ -->
	<view class="main-content" bindtap="hideSearchResults">
		<!-- æœç´¢æ¡†åŒºåŸŸ - æ‚¬æµ®åœ¨é¡¶éƒ¨çš„æœç´¢ç»„ä»¶ -->
		<view class="search-container {{isDarkMode ? 'dark-mode' : ''}}" catchtap="stopPropagation">
			<view class="search-box {{isDarkMode ? 'dark-mode' : ''}}">
				<text class="search-icon">ğŸ”</text>
				<input
				 class="search-input"
				 placeholder="æœç´¢ç›®çš„åœ°ã€æ™¯ç‚¹"
				 value="{{searchKeyword}}"
				 bindinput="onSearchInput"
				 confirm-type="search"
				 bindconfirm="performSearch"
				 focus="{{searchFocus}}"
				/>
				<text wx:if="{{searchKeyword}}" class="clear-icon" bindtap="clearSearch">
										âœ•
								</text>
			</view>
			<!-- æœç´¢ç»“æœä¸‹æ‹‰æ¡† -->
			<view wx:if="{{showSearchResults}}" class="search-results {{isDarkMode ? 'dark-mode' : ''}}">
				<!-- åŠ è½½çŠ¶æ€ -->
				<view wx:if="{{searchLoading}}" class="search-loading">
					<text>æœç´¢ä¸­...</text>
				</view>
				<!-- æœç´¢ç»“æœåˆ—è¡¨ -->
				<view wx:else>
					<view wx:if="{{searchResults.length > 0}}">
						<view
						 wx:for="{{searchResults}}"
						 wx:key="_id"
						 class="search-result-item {{isDarkMode ? 'dark-mode' : ''}}"
						 bindtap="onSearchResultTap"
						 data-id="{{item.id || item._id}}"
						 data-name="{{item.name}}"
						>							<view class="result-info">
								<text class="result-name {{isDarkMode ? 'dark-mode' : ''}}">{{item.name}}</text>
								<text class="result-address {{isDarkMode ? 'dark-mode' : ''}}">{{item.location.address}}</text>
								<view class="result-meta">
									<text class="result-rating">â­{{item.rating}}</text>
									<text class="result-price">Â¥{{item.price}}</text>
								</view>
							</view>
						</view>
					</view>
					<!-- æ— ç»“æœçŠ¶æ€ -->
					<view wx:else class="no-results {{isDarkMode ? 'dark-mode' : ''}}">
						<text>æ²¡æœ‰æ‰¾åˆ°ç›¸å…³æ™¯ç‚¹</text>
					</view>
				</view>
			</view>
		</view>
		<!-- æ»šåŠ¨å†…å®¹åŒºåŸŸ - åŒ…å«æ‰€æœ‰ä¸»è¦å†…å®¹ -->
		<scroll-view
		 class="scrollarea {{isDarkMode ? 'dark-mode' : ''}}"
		 scroll-y="{{true}}"
		 enable-flex="{{true}}"
		 enhanced="{{true}}"
		 enable-back-to-top="{{true}}"
		 show-scrollbar="{{true}}"
		 bounces="{{true}}"
		>
			<!-- åˆ†ç±»å¯¼èˆªåŒºåŸŸ - æ™¯ç‚¹åˆ†ç±»å¿«æ·å…¥å£ -->
			<view class="category-container {{isDarkMode ? 'dark-mode' : ''}}">
				<view
				 class="category-item"
				 wx:for="{{categories}}"
				 wx:key="id"
				 bindtap="goToCategory"
				 data-category="{{item.name}}"
				>
					<view class="category-icon {{isDarkMode ? 'dark-mode' : ''}}">
						{{item.icon}}
					</view>
					<view class="category-name {{isDarkMode ? 'dark-mode' : ''}}">
						{{item.name}}
					</view>
				</view>
			</view>
			<!-- çƒ­é—¨æ¨è -->
			<view class="section-title {{isDarkMode ? 'dark-mode' : ''}}">
				<text>çƒ­é—¨æ¨è</text>
				<text class="section-more {{isDarkMode ? 'dark-mode' : ''}}" bindtap="goToMoreHot">
										æŸ¥çœ‹æ›´å¤š
								</text>
			</view>
			<!-- åŠ è½½çŠ¶æ€æ˜¾ç¤º -->
			<view wx:if="{{loading}}" class="loading-container {{isDarkMode ? 'dark-mode' : ''}}">
				<view class="loading-text">æ­£åœ¨åŠ è½½æ™¯ç‚¹æ•°æ®...</view>
			</view>
			<!-- çƒ­é—¨æ™¯ç‚¹åˆ—è¡¨ -->
			<view wx:elif="{{hotSpots.length > 0}}" class="hot-spots">
				<view
				 class="hot-spot-card {{isDarkMode ? 'dark-mode' : ''}}"
				 wx:for="{{hotSpots}}"
				 wx:key="id"
				 bindtap="goToDetail"
				 data-id="{{item.id}}"
				>
					<image class="spot-image" src="{{item.mainImage || item.images[0] || item.image || '/images/default-spot.png'}}" mode="aspectFill" />
					<view class="spot-info {{isDarkMode ? 'dark-mode' : ''}}">
						<view class="spot-title {{isDarkMode ? 'dark-mode' : ''}}">
							{{item.name}}
						</view>
						<view class="spot-location {{isDarkMode ? 'dark-mode' : ''}}">
							<text class="inline-icon">ğŸ“</text>
							<text>
																{{item.location.address || item.location || item.province}}
														</text>
						</view>
						<view class="spot-meta">
							<view class="spot-price {{isDarkMode ? 'dark-mode' : ''}}">
								<text wx:if="{{item.price > 0}}">Â¥{{item.price}}</text>
								<text wx:else>å…è´¹</text>
							</view>
							<view class="spot-rating">â­ {{item.rating || 'æš‚æ— è¯„åˆ†'}}</view>
						</view>
					</view>
				</view>
			</view>
			<!-- æ— æ•°æ®æç¤º -->
			<view wx:else class="empty-container {{isDarkMode ? 'dark-mode' : ''}}">
				<view class="empty-text">æš‚æ— çƒ­é—¨æ™¯ç‚¹æ•°æ®</view>
				<view class="empty-action" bindtap="refreshData">ç‚¹å‡»åˆ·æ–°</view>
			</view>
			<!-- æ™¯ç‚¹åˆ—è¡¨ -->
			<view class="section-title {{isDarkMode ? 'dark-mode' : ''}}">
				<text>å…¨éƒ¨æ™¯ç‚¹</text>
				<text class="section-more {{isDarkMode ? 'dark-mode' : ''}}" bindtap="goToAllSpots">
										å…¨éƒ¨
								</text>
			</view>
			<!-- å…¨éƒ¨æ™¯ç‚¹åˆ—è¡¨ -->
			<view wx:if="{{!loading && allSpots.length > 0}}" class="spots-container">
				<view class="spot-list">
					<view
					 class="spot-item {{isDarkMode ? 'dark-mode' : ''}}"
					 wx:for="{{allSpots}}"
					 wx:key="id"
					 bindtap="goToDetail"
					 data-id="{{item.id}}"
					>
						<!-- å†…è”å¡ç‰‡å¸ƒå±€ä»£æ›¿spot-cardç»„ä»¶ -->
						<view class="inline-card {{isDarkMode ? 'dark-mode' : ''}}">
							<!-- æ™¯ç‚¹å›¾ç‰‡ -->
							<image
							 class="inline-image"
							 src="{{item.mainImage || item.images[0] || item.image || '/images/default-spot.png'}}"
							 mode="aspectFill"
							 lazy-load="true"
							/>
							<!-- æ™¯ç‚¹è¯„åˆ† -->
							<view class="inline-badge {{isDarkMode ? 'dark-mode' : ''}}">
								{{item.rating || 'æš‚æ— è¯„åˆ†'}}
							</view>
							<!-- æ™¯ç‚¹ä¿¡æ¯ -->
							<view class="inline-info {{isDarkMode ? 'dark-mode' : ''}}">
								<!-- æ™¯ç‚¹åç§° -->
								<view class="inline-title {{isDarkMode ? 'dark-mode' : ''}}">
									{{item.name}}
								</view>
								<!-- æ™¯ç‚¹ä½ç½® -->
								<view class="inline-location {{isDarkMode ? 'dark-mode' : ''}}">
									<text class="inline-icon">ğŸ“</text>
									<text>
																				{{item.location.address || item.location || item.province}}
																		</text>
								</view>
								<!-- æ™¯ç‚¹åˆ†ç±»å’Œä»·æ ¼ -->
								<view class="inline-meta">
									<view class="inline-category {{isDarkMode ? 'dark-mode' : ''}}">
										{{item.category || 'æ™¯ç‚¹'}}
									</view>
									<view class="inline-price {{isDarkMode ? 'dark-mode' : ''}}">
										<text wx:if="{{item.price > 0}}">Â¥{{item.price}}</text>
										<text wx:else class="free-tag">å…è´¹</text>
									</view>
								</view>
							</view>
						</view>
					</view>
				</view>
			</view>
			<!-- æ— æ™¯ç‚¹æ•°æ®æç¤º -->
			<view wx:elif="{{!loading && allSpots.length === 0}}" class="empty-container {{isDarkMode ? 'dark-mode' : ''}}">
				<view class="empty-text">æš‚æ— æ™¯ç‚¹æ•°æ®</view>
				<view class="empty-action" bindtap="refreshData">ç‚¹å‡»åˆ·æ–°</view>
			</view>
			<!-- åº•éƒ¨å®‰å…¨åŒº -->
			<view class="safe-bottom" style="height: 110rpx;" />
		</scroll-view>
	</view>
	<!-- ç»“æŸmain-content -->
</view>
<!-- è‡ªå®šä¹‰tabBarç»„ä»¶ -->
<custom-tab-bar/>

