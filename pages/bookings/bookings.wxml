<!-- ================================================================
 * æ–‡ä»¶å: bookings.wxml
 * æè¿°: æ—…æ¸¸ç®¡ç†å¾®ä¿¡å°ç¨‹åºçš„é¢„è®¢é¡µé¢ç»“æ„æ–‡ä»¶
 * ç‰ˆæœ¬: 1.0.0
 * åˆ›å»ºæ—¥æœŸ: 2025-05-13
 * ä½œè€…: Tourism_Managementå¼€å‘å›¢é˜Ÿ
 * 
 * åŠŸèƒ½è¯´æ˜:
 * - å±•ç¤ºç”¨æˆ·æ‰€æœ‰æ—…æ¸¸æ™¯ç‚¹é¢„è®¢è®°å½•
 * - æ˜¾ç¤ºé¢„è®¢è¯¦æƒ…ï¼ŒåŒ…æ‹¬è®¢å•å·ã€çŠ¶æ€ã€æ™¯ç‚¹ä¿¡æ¯ã€ä»·æ ¼å’Œæ—¥æœŸ
 * - æä¾›é¢„è®¢ä½¿ç”¨å’Œå–æ¶ˆåŠŸèƒ½
 * - æ”¯æŒå¤šä¸»é¢˜è‰²å’Œæ·±è‰²æ¨¡å¼
 * - å¤„ç†æ— é¢„è®¢è®°å½•çš„ç©ºçŠ¶æ€å±•ç¤º
 * ================================================================ -->
<!-- é¡µé¢å®¹å™¨: æ ¹æ®æ·±è‰²æ¨¡å¼å’Œä¸»é¢˜ç±»é…ç½®æ ·å¼ -->
<view class="container {{isDarkMode ? 'dark-mode' : ''}} {{themeClass}}">
	<!-- é¡µé¢å¤´éƒ¨: æ˜¾ç¤ºæ ‡é¢˜å’Œé¢„è®¢è®¡æ•° -->
	<view class="page-header {{isDarkMode ? 'dark-mode' : ''}}">
		<view class="page-title {{isDarkMode ? 'dark-mode' : ''}}">æˆ‘çš„é¢„è®¢</view>
		<view class="count-badge {{isDarkMode ? 'dark-mode' : ''}}">
			å…±{{bookings.length}}ä¸ª
		</view>
	</view>
	<!-- é¢„è®¢åˆ—è¡¨åŒºåŸŸ: å½“æœ‰é¢„è®¢è®°å½•æ—¶æ˜¾ç¤º -->
	<view class="bookings-list {{isDarkMode ? 'dark-mode' : ''}}" wx:if="{{bookings.length > 0}}">
		<!-- é¢„è®¢å¡ç‰‡: å¾ªç¯æ¸²æŸ“æ¯ä¸ªé¢„è®¢é¡¹ -->
		<view wx:for="{{bookings}}" wx:key="id" class="booking-card {{isDarkMode ? 'dark-mode' : ''}}">
			<!-- è®¢å•ä¿¡æ¯é¡¶éƒ¨: æ˜¾ç¤ºè®¢å•å·å’ŒçŠ¶æ€ -->
			<view class="booking-top {{isDarkMode ? 'dark-mode' : ''}}">
				<view class="booking-id {{isDarkMode ? 'dark-mode' : ''}}">
					è®¢å•å·: {{item.id}}
				</view>
				<view class="booking-status {{item.status === 'å·²ä½¿ç”¨' ? 'used' : ''}} {{isDarkMode ? 'dark-mode' : ''}}">
					{{item.status}}
				</view>
			</view>
			<!-- æ™¯ç‚¹ä¿¡æ¯åŒºåŸŸ: ä¼˜å…ˆä½¿ç”¨spot-cardç»„ä»¶æ˜¾ç¤ºæ™¯ç‚¹ä¿¡æ¯ -->
			<view wx:if="{{item.spotInfo}}" class="{{isDarkMode ? 'dark-mode' : ''}}">
				<spot-card
				 spot="{{item.spotInfo}}"
				 isDarkMode="{{isDarkMode}}"
				 bindtap="goToDetail"
				 data-id="{{item.spotId}}"
				/>
			</view>
			<!-- æ²¡æœ‰spot-cardæ•°æ®æ—¶çš„å¤‡ç”¨æ˜¾ç¤º: æ˜¾ç¤ºåŸºæœ¬æ™¯ç‚¹ä¿¡æ¯ -->
			<view
			 wx:else
			 class="booking-content {{isDarkMode ? 'dark-mode' : ''}}"
			 bindtap="goToDetail"
			 data-id="{{item.spotId}}"
			>
				<view class="booking-spot {{isDarkMode ? 'dark-mode' : ''}}">
					{{item.spotName}}
				</view>
				<view class="booking-info {{isDarkMode ? 'dark-mode' : ''}}">
					<view class="booking-date {{isDarkMode ? 'dark-mode' : ''}}">
						<text class="info-icon {{isDarkMode ? 'dark-mode' : ''}}">ğŸ“…</text>
						<text class="{{isDarkMode ? 'dark-mode' : ''}}">
														æ—¥æœŸ: {{item.date}}
												</text>
					</view>
					<view class="booking-price {{isDarkMode ? 'dark-mode' : ''}}">
						<text wx:if="{{item.price > 0}}" class="{{isDarkMode ? 'dark-mode' : ''}}">
														Â¥{{item.price}}
												</text>
						<text wx:else class="{{isDarkMode ? 'dark-mode' : ''}}">å…è´¹</text>
					</view>
				</view>
			</view>
			<!-- è®¢å•æ“ä½œæŒ‰é’®åŒºåŸŸ: æä¾›ä½¿ç”¨å’Œå–æ¶ˆåŠŸèƒ½ -->
			<view class="booking-actions {{isDarkMode ? 'dark-mode' : ''}}">
				<view
				 class="action-btn primary {{isDarkMode ? 'dark-mode' : ''}}"
				 wx:if="{{item.status !== 'å·²ä½¿ç”¨'}}"
				 catchtap="useBooking"
				 data-index="{{index}}"
				>
					ä½¿ç”¨
				</view>
				<view class="action-btn secondary {{isDarkMode ? 'dark-mode' : ''}}" catchtap="cancelBooking" data-index="{{index}}">
					å–æ¶ˆ
				</view>
			</view>
		</view>
	</view>
	<!-- ç©ºçŠ¶æ€è§†å›¾: å½“æ²¡æœ‰é¢„è®¢è®°å½•æ—¶æ˜¾ç¤º -->
	<view class="empty-view {{isDarkMode ? 'dark-mode' : ''}}" wx:else>
		<image class="empty-icon" src="/images/empty-bookings.png" mode="aspectFit" />
		<view class="empty-text {{isDarkMode ? 'dark-mode' : ''}}">æš‚æ— é¢„è®¢è®°å½•</view>
		<view class="empty-tips {{isDarkMode ? 'dark-mode' : ''}}">
			æ‚¨å¯ä»¥åœ¨æ™¯ç‚¹è¯¦æƒ…é¡µè¿›è¡Œé¢„è®¢
		</view>
		<button class="action-btn {{isDarkMode ? 'dark-mode' : ''}}" bindtap="goToHome">
			å»é¦–é¡µçœ‹çœ‹
		</button>
	</view>
</view>
<!-- ä¸»é¢˜è¾…åŠ©æ¨¡å—: ç”¨äºåœ¨é¡µé¢åŠ è½½æ—¶è®¾ç½®ä¸»é¢˜é¢œè‰² -->
<wxs module="themeHelper">
	// å¯¼å‡ºä¸»é¢˜è®¾ç½®å‡½æ•°
	module.exports = {
	// ä¸»é¢˜è®¾ç½®å‡½æ•°: ä»å…¨å±€æ•°æ®è·å–é¢œè‰²ä¸»é¢˜å¹¶åº”ç”¨åˆ°å½“å‰é¡µé¢
	setTheme: function() {
	var pages = getCurrentPages(); // è·å–é¡µé¢æ ˆ
	var page = pages[pages.length - 1]; // è·å–å½“å‰é¡µé¢
	if (page) {
	page.setData({ // è®¾ç½®é¡µé¢æ•°æ®
	pageTheme: getApp().globalData.colorTheme // ä»å…¨å±€æ•°æ®è·å–é¢œè‰²ä¸»é¢˜
	});
	}
	}
	}
</wxs>

